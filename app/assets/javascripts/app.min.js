var drip8=angular.module("Drip8",["angular-flexslider"]);window.fbAsyncInit=function(){FB.init({appId:"719176184895882",status:!0,xfbml:!0,version:"v2.3"})},drip8.directive("auth",[function(){return{restrict:"A",scope:!0,link:function(i,t,e){i.login=function(){window.location="/auth/facebook"}}}}]),drip8.directive("bucket",["$rootScope","$http",function(i,t){return{restrict:"A",scope:!0,link:function(e,r,o){e.profileData={},e.buckets=[],e.newDrip=function(t){i.$broadcast("drip-new",t)},e.getDrip=function(i){t.post("/api/read_drips_by_bucket_and_user",{user_id:e.profileData.id,dripbucket_id:i}).success(function(i){console.log(i)})},e.newBucket=function(i){$("#createDripBoardBox").modal("hide"),t.post("/api/add_bucket",{bucket:{user_id:e.profileData.id,name:i.name,state:i.state}}).success(function(i){window.location.reload()})},e.getAllBucket=function(){t.post("/api/read_all_bucket_by_user",{user_id:e.profileData.id}).success(function(i){e.buckets=i.buckets})},e.$on("profile-data",function(i,t){e.profileData=t,e.getAllBucket()})}}}]),drip8.directive("dripDashboard",["$http","$rootScope",function(i,t){return{restrict:"A",scope:!0,link:function(e,r,o){e.drips=[],i.get("/api/drip_length").success(function(i){for(var t=[],r=i.count-1;r>=i.count-3;r--)t.push(r);var o=n(t);async.parallel(o,function(i,t){e.drips=t})});var n=function(t){var e=[];return t.forEach(function(t){e.push(function(e){i.post("/api/drip_each",{drip_id:t}).success(function(i){e(null,i)})})}),e};e.seeBucket=function(i){console.log("see Bucket"),t.$broadcast("see-bucket",i)}}}}]),drip8.directive("dripList",["$http","Video","$rootScope",function(i,t,e){return{restrict:"A",scope:!0,link:function(r,o,n){var c=n.dripList.split("-");r.drips=[],r.dripListing=function(){i.post("/api/read_drips_by_bucket_and_user",{dripbucket_id:c[0],user_id:c[1]}).success(function(i){r.drips=i.drips})},r.linkUri=function(i,e){var r=i.split("v=")[1],o=r.indexOf("&");return-1!=o&&(r=r.substring(0,o)),"thumb"==e?t.thumbnail(r):t.videoSource(r)},r.showVideo=function(i){$("#videoLink").modal("show"),e.$broadcast("video-source",i)},r.dripListing(),r.$on("drips-reload",function(){r.dripListing()})}}}]),drip8.directive("dripModalBucket",["$http","$rootScope","Video",function(i,t,e){return{restrict:"A",scope:!0,link:function(i,r,o){console.log("drip-modal-bucket"),t.$on("see-bucket",function(t,r){i.directDrip=e.videoSource(r.drip.link.split("v=")[1]),i.dripBucketDetails=r;for(var o=0;o<=r.drip.dripbucket.drips.length-1;o++){var n=i.dripBucketDetails.drip.dripbucket.drips[o].link.split("v=")[1];console.log(n),i.dripBucketDetails.drip.dripbucket.drips[o].thumb=e.thumbnail(n),console.log(i.dripBucketDetails.drip.dripbucket.drips[o].thumb),console.log(i.dripBucketDetails.drip.dripbucket.drips[o].link)}console.log(i.dripBucketDetails)}),i.changeVideo=function(t){i.$broadcast("change-video",t)},i.$on("change-video",function(t,r){i.directDrip=e.videoSource(r.split("v=")[1])})}}}]),drip8.directive("drip",["$http","$rootScope",function(i,t){return{restrict:"A",scope:!0,link:function(e,r,o){e.dripDetails={state:"public"},e.profileData={},e.addDrip=function(){$("#addADrip").modal("hide"),e.dripDetails.user_id=e.profileData.id,i.post("/api/add_drip",{drip:e.dripDetails}).success(function(i){t.$broadcast("drips-reload"),e.dripDetails={state:"public"}})},e.$on("drip-new",function(i,t){e.dripDetails.dripbucket_id=t}),e.$on("profile-data",function(i,t){e.profileData=t})}}}]),drip8.directive("feature",["$http",function(i){return{restrict:"A",scope:!0,link:function(t,e,r){var o=r.feature.split("-");e.bind("click",function(){i.post("/api/new_featured",{user_id:o[0],drip_id:o[1]}).success(function(i){window.location.reload()})})}}}]),drip8.directive("profile",["$http","Video","$rootScope",function(i,t,e){return{restrict:"A",scope:!0,link:function(r,o,n){console.log("profile"),r.profile={},r.getUserInfo=function(){i.get("/api/user").success(function(i){r.profile=i.data,r.trustUrl()})},r.trustUrl=function(){var o="";i.post("/api/video_featured",{user_id:r.profile.id}).success(function(i){if(i.link){o=i.link.split("v=")[1];var n=o.indexOf("&");-1!=n&&(o=o.substring(0,n))}r.profile.featured=i.link,e.$broadcast("profile-data",r.profile),r.profile.featuredVideo=t.videoSource(o)})},r.getUserInfo()}}}]),drip8.directive("to",[function(){return{restrict:"A",scope:!0,link:function(i,t,e){t.bind("click",function(){window.location=e.to})}}}]),drip8.directive("uiTemplate",[function(){return{restrict:"E",scope:!0,templateUrl:function(i,t){return"/api/template?template="+t.ngTemplate}}}]),drip8.directive("videoDashboard",["$http","Video",function(i,t){return{restrict:"A",scope:!0,link:function(i,e,r){i.videoSrc=t.videoSource(r.videoSource.split("v=")[1])}}}]),drip8.directive("videoLink",[function(){return{restrict:"A",scope:!0,link:function(i,t,e){i.videoSource,$("#videoLink").on("hidden.bs.modal",function(){i.$apply(function(){i.videoSource=""})}),i.$on("video-source",function(t,e){i.videoSource=e})}}}]),drip8.factory("Video",["$sce",function(i){return this.thumbnail=function(t){return i.trustAsResourceUrl("http://img.youtube.com/vi/"+t+"/0.jpg")},this.videoSource=function(t){return i.trustAsResourceUrl("https://www.youtube.com/embed/"+t+"?rel=0&nologo=1&showinfo=0&modestbranding=1&iv_load_policy=3")},this}]);
//# sourceMappingURL=app.min.js.map
