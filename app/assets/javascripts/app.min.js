var drip8=angular.module("Drip8",[]);window.fbAsyncInit=function(){FB.init({appId:"719176184895882",status:!0,xfbml:!0,version:"v2.3"})},drip8.directive("auth",[function(){return{restrict:"A",scope:!0,link:function(i,t,e){i.login=function(){window.location="/auth/facebook"}}}}]),drip8.directive("bucket",["$rootScope","$http",function(i,t){return{restrict:"A",scope:!0,link:function(e,o,r){e.profileData={},e.buckets=[],e.newDrip=function(t){i.$broadcast("drip-new",t)},e.getDrip=function(i){t.post("/api/read_drips_by_bucket_and_user",{user_id:e.profileData.id,dripbucket_id:i}).success(function(i){console.log(i)})},e.newBucket=function(i){$("#createDripBoardBox").modal("hide"),t.post("/api/add_bucket",{bucket:{user_id:e.profileData.id,name:i.name,state:i.state}}).success(function(i){window.location.reload()})},e.getAllBucket=function(){t.post("/api/read_all_bucket_by_user",{user_id:e.profileData.id}).success(function(i){e.buckets=i.buckets})},e.$on("profile-data",function(i,t){e.profileData=t,e.getAllBucket()})}}}]),drip8.directive("dripDashboard",["$http","Video","$rootScope",function(i,t,e){return{restrict:"A",scope:!0,compile:function(t,o){return{pre:function(t,e,o){t.drips=[],t.queryAllDrips=function(){i.get("/api/drip_length").success(function(e){if(0!=e.count){t.count=e.count;var o=1;t.responsed=[];for(var r=3;r>=0;r--){var n=t.count-o;console.log(n),i.post("/api/drip_each",{drip_id:n}).success(function(i){t.responsed.push(i),console.log(i)}),o++}}}),t.$broadcast("end-fetch",t.responsed)},t.queryAllDrips()},post:function(i,t,o){i.queryEachDrip=function(){},i.linkUri=function(t,o){console.log(t);var r=t.split("v=")[1];i.video_id=r;var n=r.indexOf("&");return-1!=n&&(r=r.substring(0,n)),"thumb"!=o?e.videoSource(r):void 0}}}}}}]),drip8.directive("dripList",["$http","Video","$rootScope",function(i,t,e){return{restrict:"A",scope:!0,link:function(o,r,n){var c=n.dripList.split("-");o.drips=[],o.dripListing=function(){i.post("/api/read_drips_by_bucket_and_user",{dripbucket_id:c[0],user_id:c[1]}).success(function(i){o.drips=i.drips})},o.linkUri=function(i,e){var o=i.split("v=")[1],r=o.indexOf("&");return-1!=r&&(o=o.substring(0,r)),"thumb"==e?t.thumbnail(o):t.videoSource(o)},o.showVideo=function(i){$("#videoLink").modal("show"),e.$broadcast("video-source",i)},o.dripListing(),o.$on("drips-reload",function(){o.dripListing()})}}}]),drip8.directive("dripModalBucket",["$http","$rootScope",function(i,t){return{restrict:"A",scope:!0,link:function(i,t,e){console.log("drip-modal-bucket")}}}]),drip8.directive("drip",["$http","$rootScope",function(i,t){return{restrict:"A",scope:!0,link:function(e,o,r){e.dripDetails={state:"public"},e.profileData={},e.addDrip=function(){$("#addADrip").modal("hide"),e.dripDetails.user_id=e.profileData.id,i.post("/api/add_drip",{drip:e.dripDetails}).success(function(i){t.$broadcast("drips-reload"),e.dripDetails={state:"public"}})},e.$on("drip-new",function(i,t){e.dripDetails.dripbucket_id=t}),e.$on("profile-data",function(i,t){e.profileData=t})}}}]),drip8.directive("feature",["$http",function(i){return{restrict:"A",scope:!0,link:function(t,e,o){var r=o.feature.split("-");e.bind("click",function(){i.post("/api/new_featured",{user_id:r[0],drip_id:r[1]}).success(function(i){window.location.reload()})})}}}]),drip8.directive("profile",["$http","Video","$rootScope",function(i,t,e){return{restrict:"A",scope:!0,link:function(o,r,n){console.log("profile"),o.profile={},o.getUserInfo=function(){i.get("/api/user").success(function(i){o.profile=i.data,o.trustUrl()})},o.trustUrl=function(){var r="";i.post("/api/video_featured",{user_id:o.profile.id}).success(function(i){if(i.link){r=i.link.split("v=")[1];var n=r.indexOf("&");-1!=n&&(r=r.substring(0,n))}o.profile.featured=i.link,e.$broadcast("profile-data",o.profile),o.profile.featuredVideo=t.videoSource(r)})},o.getUserInfo()}}}]),drip8.directive("to",[function(){return{restrict:"A",scope:!0,link:function(i,t,e){t.bind("click",function(){window.location=e.to})}}}]),drip8.directive("uiTemplate",[function(){return{restrict:"E",scope:!0,templateUrl:function(i,t){return"/api/template?template="+t.ngTemplate}}}]),drip8.directive("videoDashboard",["$http","Video","$rootScope","$sce",function(i,t,e,o){return{restrict:"A",scope:{videoSrc:"="},link:function(i,t,e){i.videoSrc=o.trustAsResourceUrl(i.videoSrc)}}}]),drip8.directive("videoLink",[function(){return{restrict:"A",scope:!0,link:function(i,t,e){i.videoSource,$("#videoLink").on("hidden.bs.modal",function(){i.$apply(function(){i.videoSource=""})}),i.$on("video-source",function(t,e){i.videoSource=e})}}}]),drip8.factory("Video",["$sce",function(i){return this.thumbnail=function(t){return i.trustAsResourceUrl("http://img.youtube.com/vi/"+t+"/0.jpg")},this.videoSource=function(t){return i.trustAsResourceUrl("https://www.youtube.com/embed/"+t+"?rel=0&nologo=1&showinfo=0&modestbranding=1&iv_load_policy=3")},this}]);
//# sourceMappingURL=app.min.js.map
